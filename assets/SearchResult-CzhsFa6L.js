import{t as N,v as X,x as U,y as Z,z as ee,A as se,B as te,p as L,D as w,q as t,E as le,w as ae,G as ie,R as $,H as re,J as ue,K as ne,L as oe,M as ce,N as I,O as T,Q as ve,S as me,T as de,U as he,V as ye,W as pe,X as ge,Y as Ee,Z as _,_ as fe,$ as B}from"./app-CHBjHCQA.js";const Ae=["/","/demo/","/demo/disable.html","/demo/layout.html","/demo/markdown.html","/demo/page.html","/posts/intro.html","/posts/life/intro.html","/posts/tech/intro.html","/services/e-menu/emenu.html","/services/translation/translation.html","/services/web-dev/dev.html","/posts/life/documents/vidaLaboral.html","/posts/life/drivingLicense/renewDriverLicense.html","/404.html","/posts/","/posts/life/","/posts/tech/","/services/e-menu/","/services/","/services/translation/","/services/web-dev/","/posts/life/documents/","/posts/life/drivingLicense/","/category/","/category/guide/","/category/%E8%A5%BF%E7%8F%AD%E7%89%99%E7%94%9F%E6%B4%BB/","/category/%E5%AE%9E%E7%94%A8%E6%96%87%E6%A1%A3/","/en/category/","/tag/","/tag/disable/","/tag/encryption/","/tag/layout/","/tag/markdown/","/tag/page-config/","/tag/guide/","/tag/%E5%B7%A5%E4%BD%9C%E8%AF%81%E6%98%8E/","/tag/%E5%AE%98%E6%96%B9%E6%96%87%E4%BB%B6/","/tag/%E5%AE%9E%E7%94%A8%E6%8C%87%E5%8D%97/","/tag/%E8%A5%BF%E7%8F%AD%E7%89%99%E7%A4%BE%E4%BF%9D/","/tag/%E9%A9%BE%E7%85%A7/","/tag/%E8%AF%81%E4%BB%B6%E5%8A%9E%E7%90%86/","/tag/%E4%BA%A4%E9%80%9A/","/en/tag/","/article/","/en/article/","/star/","/en/star/","/timeline/","/en/timeline/"],He="SLIMSEARCH_QUERY_HISTORY",p=_(He,[]),we=()=>{const{queryHistoryCount:a}=B;return{enabled:a>0,queryHistories:p,addQueryHistory:u=>{p.value=Array.from(new Set([u,...p.value.slice(0,a-1)]))},removeQueryHistory:u=>{p.value=[...p.value.slice(0,u),...p.value.slice(u+1)]}}},S=a=>Ae[a.id]+("anchor"in a?`#${a.anchor}`:""),Be="SLIMSEARCH_RESULT_HISTORY",{resultHistoryCount:M}=B,g=_(Be,[]),ke=()=>({enabled:M>0,resultHistories:g,addResultHistory:r=>{{const u={link:S(r),display:r.display};"header"in r&&(u.header=r.header),g.value=[u,...g.value.slice(0,M-1)]}},removeResultHistory:r=>{g.value=[...g.value.slice(0,r),...g.value.slice(r+1)]}}),Re=a=>{const r=ve(),u=U(),k=me(),n=L(0),E=w(()=>n.value>0),v=de([]);return he(()=>{const{search:R,terminate:d}=ye(),f=ge(h=>{const{resultsFilter:Q=l=>l,querySplitter:y,suggestionsFilter:C,...i}=r.value;h?(n.value+=1,R(h,u.value,i).then(l=>Q(l,h,u.value,k.value)).then(l=>{n.value-=1,v.value=l}).catch(l=>{console.warn(l),n.value-=1,n.value||(v.value=[])})):v.value=[]},B.searchDelay-B.suggestDelay,{maxWait:5e3});pe([a,u],([h])=>f(h.join(" "))),Ee(()=>{d()})}),{isSearching:E,results:v}};var qe=N({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(a,{emit:r}){const u=X(),k=U(),n=Z(ee),{addQueryHistory:E,queryHistories:v,removeQueryHistory:R}=we(),{resultHistories:d,addResultHistory:f,removeResultHistory:h}=ke(),Q=se(a,"queries"),{results:y,isSearching:C}=Re(Q),i=te({isQuery:!0,index:0}),l=L(0),m=L(0),F=w(()=>v.value.length>0||d.value.length>0),q=w(()=>y.value.length>0),x=w(()=>y.value[l.value]||null),j=()=>{const{isQuery:e,index:s}=i;s===0?(i.isQuery=!e,i.index=e?d.value.length-1:v.value.length-1):i.index=s-1},O=()=>{const{isQuery:e,index:s}=i;s===(e?v.value.length-1:d.value.length-1)?(i.isQuery=!e,i.index=0):i.index=s+1},P=()=>{l.value=l.value>0?l.value-1:y.value.length-1,m.value=x.value.contents.length-1},Y=()=>{l.value=l.value<y.value.length-1?l.value+1:0,m.value=0},V=()=>{m.value<x.value.contents.length-1?m.value+=1:Y()},W=()=>{m.value>0?m.value-=1:P()},D=e=>e.map(s=>fe(s)?s:t(s[0],s[1])),z=e=>{if(e.type==="customField"){const s=oe[e.index]||"$content",[o,H=""]=ce(s)?s[k.value].split("$content"):s.split("$content");return e.display.map(c=>t("div",D([o,...c,H])))}return e.display.map(s=>t("div",D(s)))},A=()=>{l.value=0,m.value=0,r("updateQuery",""),r("close")},G=()=>t("ul",{class:"slimsearch-result-list"},t("li",{class:"slimsearch-result-list-item"},[t("div",{class:"slimsearch-result-title"},n.value.queryHistory),v.value.map((e,s)=>t("div",{class:["slimsearch-result-item",{active:i.isQuery&&i.index===s}],onClick:()=>{r("updateQuery",e)}},[t(I,{class:"slimsearch-result-type"}),t("div",{class:"slimsearch-result-content"},e),t("button",{class:"slimsearch-remove-icon",innerHTML:T,onClick:o=>{o.preventDefault(),o.stopPropagation(),R(s)}})]))])),J=()=>t("ul",{class:"slimsearch-result-list"},t("li",{class:"slimsearch-result-list-item"},[t("div",{class:"slimsearch-result-title"},n.value.resultHistory),d.value.map((e,s)=>t($,{to:e.link,class:["slimsearch-result-item",{active:!i.isQuery&&i.index===s}],onClick:()=>{A()}},()=>[t(I,{class:"slimsearch-result-type"}),t("div",{class:"slimsearch-result-content"},[e.header?t("div",{class:"content-header"},e.header):null,t("div",e.display.map(o=>D(o)).flat())]),t("button",{class:"slimsearch-remove-icon",innerHTML:T,onClick:o=>{o.preventDefault(),o.stopPropagation(),h(s)}})]))]));return le("keydown",e=>{if(a.isFocusing){if(q.value){if(e.key==="ArrowUp")W();else if(e.key==="ArrowDown")V();else if(e.key==="Enter"){const s=x.value.contents[m.value];E(a.queries.join(" ")),f(s),u.push(S(s)),A()}}else if(e.key==="ArrowUp")j();else if(e.key==="ArrowDown")O();else if(e.key==="Enter"){const{index:s}=i;i.isQuery?(r("updateQuery",v.value[s]),e.preventDefault()):(u.push(d.value[s].link),A())}}}),ae([l,m],()=>{var e;(e=document.querySelector(".slimsearch-result-list-item.active .slimsearch-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>t("div",{class:["slimsearch-result-wrapper",{empty:a.queries.length?!q.value:!F.value}],id:"slimsearch-results"},a.queries.length?C.value?t(ie,{hint:n.value.searching}):q.value?t("ul",{class:"slimsearch-result-list"},y.value.map(({title:e,contents:s},o)=>{const H=l.value===o;return t("li",{class:["slimsearch-result-list-item",{active:H}]},[t("div",{class:"slimsearch-result-title"},e||n.value.defaultTitle),s.map((c,K)=>{const b=H&&m.value===K;return t($,{to:S(c),class:["slimsearch-result-item",{active:b,"aria-selected":b}],onClick:()=>{E(a.queries.join(" ")),f(c),A()}},()=>[c.type==="text"?null:t(c.type==="title"?re:c.type==="heading"?ue:ne,{class:"slimsearch-result-type"}),t("div",{class:"slimsearch-result-content"},[c.type==="text"&&c.header?t("div",{class:"content-header"},c.header):null,t("div",z(c))])])})])})):n.value.emptyResult:F.value?[G(),J()]:n.value.emptyHistory)}});export{qe as default};
